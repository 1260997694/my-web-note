# HTTPS学习

## 对称加密和非对称加密（相关知识）
### 对称加密（共享秘钥加密）   
定义： 使用加密解密的秘钥一样。  
常见的算法有：DES，AES等。  
优缺点： 对称加密相比较非对称加密来说，加解密效率要高得多，加密速度快。但是缺陷在于对称加密的秘钥管理和分发上比较困难，非常不安全。

### 非对称加密（公开密钥加密）  
定义：使用加密和解密的秘钥不一样。通信两端AB都有一对秘钥，公钥和私钥，A私钥加密的内容只有A公钥可以解开。A公钥一般是分发给B，这里会存在公钥认证问题，需要第三方进行公证B收到的公钥是来自A。同理，A公钥加密的内容只有A私钥能解开。
常见的算法有：RSA等。
优缺点：安全性高，公钥是公开的，私钥自己保存。缺点：加密和解密花费时间长，速度慢，只适合对少量数据进行加密。

### 总结
对称加密效率高，安全性不好，非对称加密安全性好，效率不高    

两者联合使用：既然非对称加密是安全的，我们可以使用非对称加密将对称加密的秘钥分发给客户端，之后再使用对称加密来通信。这就是混合加密算法。


## HTTPS出现背景
HTTP缺点：
1. 明文传输，而且能被传输路途中任意设备窃听
2. 服务器和客户端之间无法认证真实身份，容易被伪装
3. 数据完整性保护上不够便捷和可靠
HTTPS的出现就是为解决这几个问题。

## HTTPS定义原理
### 定义
HTTPS = HTTP + 加密 + 认证 + 数据完整性保护

### HTTPS加密机制
采用混合加密算法，综合利用对称加密的效率高和非对称加密的安全性，首先使用‘非对称加密’来分发‘对称加密’的秘钥，之后的通信都使用对称加密来进行。

### 大体流程
一个大致的图：
![HTTPS原理大体流程图](https://user-gold-cdn.xitu.io/2018/5/21/1638197d96d391ca?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

#### 准备阶段：  
1. 服务器向第三认证机构CA(Certificate Authority)请求签名证书
2. 服务器会将自己的公钥发给第三认证机构CA
3. 第三认证机构用自己的私钥将服务器的公钥和服务器的信息进行加密，形成签名证书，最后颁发给服务器

#### 正式阶段：  
1. 浏览器请求服务器的公钥
2. 服务器发送‘公钥A’以及认证机构CA签发的‘签名证书B'
3. 浏览器用预装好的‘认证机构CA的公钥’对服务器发过来的‘签名证书B’进行解密，将解密出来的公钥信息和从服务器收到的公钥信息进行对比验证。
4. 如果验证不通过，直接断开连接。
5. 如果验证通过，浏览器随机生成‘对称加密的秘钥C’，并使用浏览器发过来的‘公钥A’对‘对称加密的秘钥C’进行加密，最后通过报文将加密信息发给服务器。
6. 服务器通过自己的私钥进行信息加密，得到‘对称加密的秘钥C’
7. 最后，浏览器和服务器的通信的使用对称加密来进行，加密的秘钥是‘对称加密的秘钥C’。

#### 小知识点
第三方认证机构在做服务器和客户端之间的公证时使用的加密算法是非对称加密，首先对服务器的公钥使用私钥进行加密形成签名证书，之后客户端会预装好第三方认证机构CA的公钥，最后客户端就可以使用CA的公钥对服务器发过来的签名证书进行加密。因为签名证书是用CA的私钥加密的。



## HTTPS三次握手

## HTTPS优化




## 可参考文章
[白话解释 对称加密算法 VS 非对称加密算法](https://segmentfault.com/a/1190000004461428)
[大型网站的HTTPS实践（一）——HTTPS协议和原理](https://mp.weixin.qq.com/s/estsNq9lVrLhR__ShtX22Q)
[看图学HTTPS](https://juejin.im/post/5b0274ac6fb9a07aaa118f49)
[HTTPS系列1——HTTPS三次握手](https://www.zybuluo.com/blueGhost/note/805491)
